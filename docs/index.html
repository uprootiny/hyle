<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>hyle - Rust-native code assistant</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>></text></svg>">
  <style>
    :root {
      --bg: #0d1117;
      --fg: #c9d1d9;
      --dim: #6e7681;
      --accent: #7aa2f7;
      --green: #9ece6a;
      --yellow: #e0af68;
      --red: #f7768e;
      --surface: #161b22;
      --border: #30363d;
      --mono: 'Berkeley Mono', 'SF Mono', 'Fira Code', 'JetBrains Mono', monospace;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: var(--mono);
      background: var(--bg);
      color: var(--fg);
      line-height: 1.6;
      min-height: 100vh;
    }
    .container { max-width: 1000px; margin: 0 auto; padding: 2rem; }

    header { padding: 4rem 0 2rem; text-align: center; }
    h1 { font-size: 3rem; font-weight: 400; letter-spacing: -0.02em; }
    h1 span { color: var(--accent); }
    .tagline { color: var(--dim); margin-top: 0.5rem; font-size: 1.1rem; }
    .tagline-detail {
      color: var(--dim);
      font-size: 0.9rem;
      max-width: 600px;
      margin: 1.5rem auto 0;
      line-height: 1.7;
    }

    .terminal {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      margin: 2rem 0;
      overflow: hidden;
    }
    .terminal-header {
      background: #21262d;
      padding: 0.5rem 1rem;
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    .terminal-dot { width: 12px; height: 12px; border-radius: 50%; }
    .dot-red { background: #ff5f56; }
    .dot-yellow { background: #ffbd2e; }
    .dot-green { background: #27c93f; }
    .terminal-title { margin-left: auto; color: var(--dim); font-size: 0.75rem; }
    .terminal-body {
      padding: 1rem;
      font-size: 0.85rem;
      min-height: 280px;
      max-height: 350px;
      overflow-y: auto;
    }
    .terminal-line {
      margin: 0.2rem 0;
      opacity: 0;
      transform: translateY(5px);
      animation: lineIn 0.2s ease forwards;
    }
    .terminal-line .prompt { color: var(--green); }
    .terminal-line .cmd { color: var(--fg); }
    .terminal-line .output { color: var(--dim); }
    .terminal-line .success { color: var(--green); }
    .terminal-line .info { color: var(--accent); }
    .terminal-line .warn { color: var(--yellow); }
    .terminal-line .file { color: var(--yellow); text-decoration: underline; cursor: pointer; }
    .terminal-line .file:hover { color: var(--accent); }
    @keyframes lineIn { to { opacity: 1; transform: translateY(0); } }

    .terminal-controls {
      display: flex;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      background: #21262d;
      border-top: 1px solid var(--border);
      align-items: center;
    }
    .terminal-btn {
      padding: 0.3rem 0.75rem;
      background: var(--border);
      border: 1px solid #484f58;
      border-radius: 4px;
      color: var(--dim);
      font-family: var(--mono);
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.15s;
    }
    .terminal-btn:hover { background: #484f58; color: var(--fg); }
    .terminal-btn.active { background: var(--accent); color: var(--bg); border-color: var(--accent); }
    .demo-selector { margin-left: auto; display: flex; gap: 0.25rem; }
    .demo-dot {
      width: 8px; height: 8px; border-radius: 50%;
      background: var(--border); cursor: pointer; transition: all 0.2s;
    }
    .demo-dot:hover { background: var(--dim); }
    .demo-dot.active { background: var(--accent); }
    .demo-label { font-size: 0.7rem; color: var(--dim); margin-left: 0.5rem; }

    .section-header {
      margin: 4rem 0 1.5rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--border);
    }
    .section-header h2 { font-size: 1.1rem; font-weight: 500; color: var(--fg); }
    .section-header p { font-size: 0.85rem; color: var(--dim); margin-top: 0.25rem; }

    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
    }
    .feature {
      padding: 1.25rem;
      background: var(--surface);
      border-radius: 8px;
      border: 1px solid var(--border);
      transition: border-color 0.2s, transform 0.2s;
      cursor: pointer;
    }
    .feature:hover { border-color: var(--accent); transform: translateY(-2px); }
    .feature h3 {
      color: var(--accent);
      margin-bottom: 0.5rem;
      font-weight: 500;
      font-size: 0.95rem;
    }
    .feature p { color: var(--dim); font-size: 0.85rem; line-height: 1.6; }
    .feature-detail {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, margin-top 0.3s ease;
    }
    .feature.expanded .feature-detail { max-height: 250px; margin-top: 0.75rem; }
    .feature-code {
      background: var(--bg);
      padding: 0.75rem;
      border-radius: 4px;
      font-size: 0.8rem;
      overflow-x: auto;
      white-space: pre;
    }

    .examples-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1rem;
    }
    .example-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    .example-card:hover { border-color: var(--dim); }
    .example-card.expanded { grid-column: 1 / -1; border-color: var(--accent); }
    .example-header {
      padding: 1rem 1.25rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      transition: background 0.15s;
    }
    .example-header:hover { background: #1c2128; }
    .example-icon { font-size: 1.25rem; }
    .example-info { flex: 1; }
    .example-title { font-weight: 500; font-size: 0.9rem; margin-bottom: 0.15rem; }
    .example-subtitle { font-size: 0.8rem; color: var(--dim); }
    .example-tag {
      padding: 0.2rem 0.6rem;
      background: var(--bg);
      border-radius: 12px;
      font-size: 0.7rem;
      font-weight: 500;
    }
    .example-tag.easy { color: var(--green); }
    .example-tag.creative { color: var(--yellow); }
    .example-tag.wow { color: var(--red); }
    .example-expand { color: var(--dim); transition: transform 0.3s; }
    .example-card.expanded .example-expand { transform: rotate(180deg); }
    .example-body { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; }
    .example-card.expanded .example-body { max-height: 600px; }
    .example-content { padding: 0 1.25rem 1.25rem; }
    .example-prose { font-size: 0.85rem; color: var(--dim); line-height: 1.7; margin-bottom: 1rem; }
    .example-terminal { background: var(--bg); border-radius: 6px; overflow: hidden; }
    .example-terminal-header {
      padding: 0.5rem 0.75rem;
      background: #1c2128;
      font-size: 0.7rem;
      color: var(--dim);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .example-terminal-body { padding: 0.75rem; font-size: 0.8rem; max-height: 250px; overflow-y: auto; }
    .copy-btn {
      background: none;
      border: 1px solid var(--border);
      color: var(--dim);
      font-size: 0.65rem;
      padding: 0.15rem 0.4rem;
      border-radius: 3px;
      cursor: pointer;
      font-family: var(--mono);
    }
    .copy-btn:hover { color: var(--fg); border-color: var(--dim); }
    .copy-btn.copied { color: var(--green); border-color: var(--green); }

    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .cta { text-align: center; margin: 4rem 0 2rem; }
    .cta-button {
      display: inline-block;
      padding: 1rem 2.5rem;
      background: var(--accent);
      color: var(--bg);
      border-radius: 6px;
      font-weight: 500;
      font-size: 0.95rem;
      transition: all 0.2s;
    }
    .cta-button:hover { opacity: 0.9; text-decoration: none; transform: translateY(-2px); }
    .cta-secondary { display: block; margin-top: 1rem; font-size: 0.85rem; color: var(--dim); }

    footer {
      padding: 2rem;
      text-align: center;
      color: var(--dim);
      font-size: 0.8rem;
      border-top: 1px solid var(--border);
      margin-top: 2rem;
    }
    footer a { color: var(--dim); }
    footer a:hover { color: var(--accent); }

    .variant-switcher { position: fixed; bottom: 1rem; right: 1rem; z-index: 1000; }
    .switcher-toggle {
      width: 32px; height: 32px; border-radius: 50%;
      background: #21262d; border: 1px solid var(--border);
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      color: var(--dim); font-size: 14px; transition: all 0.2s;
    }
    .switcher-toggle:hover { background: var(--border); color: var(--fg); }
    .switcher-panel {
      position: absolute; bottom: 40px; right: 0;
      background: var(--surface); border: 1px solid var(--border); border-radius: 8px;
      padding: 0.5rem; display: none; min-width: 180px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }
    .switcher-panel.open { display: block; }
    .switcher-item {
      display: block; padding: 0.5rem 0.75rem; color: var(--dim);
      font-size: 0.75rem; border-radius: 4px; cursor: pointer; transition: all 0.15s;
    }
    .switcher-item:hover { background: #21262d; color: var(--fg); text-decoration: none; }
    .switcher-item.active { color: var(--accent); background: #21262d; }

    .modal-overlay {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.8); display: none;
      align-items: center; justify-content: center; z-index: 2000;
    }
    .modal-overlay.open { display: flex; }
    .modal-content {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 8px; max-width: 700px; width: 90%; max-height: 80vh; overflow: hidden;
    }
    .modal-header {
      padding: 1rem; background: #21262d;
      display: flex; justify-content: space-between; align-items: center;
    }
    .modal-title { font-size: 0.9rem; color: var(--yellow); }
    .modal-close { background: none; border: none; color: var(--dim); font-size: 1.25rem; cursor: pointer; }
    .modal-close:hover { color: var(--fg); }
    .modal-body { padding: 1rem; max-height: 60vh; overflow-y: auto; font-size: 0.8rem; }
    .line-number { color: var(--dim); user-select: none; padding-right: 1rem; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1><span>></span> hyle</h1>
      <p class="tagline">Rust-native autonomous code assistant</p>
      <p class="tagline-detail">
        A single binary that reads your codebase, understands what you want, and executes file operations and shell commands until the job is done. No JavaScript runtime, no electron wrapper, no daemon. Just <code>cargo install</code> and start building.
      </p>
    </header>

    <div class="terminal" id="mainTerminal">
      <div class="terminal-header">
        <span class="terminal-dot dot-red"></span>
        <span class="terminal-dot dot-yellow"></span>
        <span class="terminal-dot dot-green"></span>
        <span class="terminal-title" id="terminalTitle">~/code/axum-sessions</span>
      </div>
      <div class="terminal-body" id="terminalBody"></div>
      <div class="terminal-controls">
        <button class="terminal-btn" id="playBtn" onclick="toggleReplay()">Pause</button>
        <button class="terminal-btn" onclick="restartReplay()">Restart</button>
        <div class="demo-selector">
          <div class="demo-dot active" onclick="switchDemo(0)" title="Redis sessions"></div>
          <div class="demo-dot" onclick="switchDemo(1)" title="N+1 fix"></div>
          <div class="demo-dot" onclick="switchDemo(2)" title="Test failures"></div>
          <div class="demo-dot" onclick="switchDemo(3)" title="Async refactor"></div>
        </div>
        <span class="demo-label" id="demoLabel">Redis session storage</span>
      </div>
    </div>

    <div class="section-header">
      <h2>Core capabilities</h2>
      <p>What makes hyle different from chat-based assistants</p>
    </div>

    <div class="features">
      <div class="feature" onclick="toggleFeature(this)">
        <h3>Agentic execution loop</h3>
        <p>Unlike chat interfaces that show you code to copy-paste, hyle executes tools directly. It reads files, writes changes, runs your build, checks the output, and iterates until the task is complete.</p>
        <div class="feature-detail">
          <div class="feature-code"><span style="color:var(--green)">></span> add rate limiting to the /api/upload endpoint

<span style="color:var(--accent)">[read]</span> src/routes/upload.rs (247 lines)
<span style="color:var(--accent)">[read]</span> src/middleware/mod.rs (89 lines)
<span style="color:var(--accent)">[write]</span> src/middleware/rate_limit.rs (63 lines)
<span style="color:var(--accent)">[patch]</span> src/routes/upload.rs (+4 -1 lines)
<span style="color:var(--accent)">[bash]</span> cargo check
<span style="color:var(--green)">Done.</span> Token bucket at 100 req/min</div>
        </div>
      </div>

      <div class="feature" onclick="toggleFeature(this)">
        <h3>35+ free models via OpenRouter</h3>
        <p>Access DeepSeek-V3, Qwen 32B, Mistral, Llama at zero cost. Or use Claude, GPT-4 when you need maximum capability. Switch models mid-session with <code>/model</code>.</p>
        <div class="feature-detail">
          <div class="feature-code"><span style="color:var(--green)">$</span> hyle --free
<span style="color:var(--dim)">[Using deepseek/deepseek-chat-v3-0324:free]</span>

<span style="color:var(--green)">></span> /models --free
<span style="color:var(--yellow)">Free models:</span>
  deepseek/deepseek-chat-v3-0324:free
  qwen/qwen-2.5-coder-32b-instruct:free
  meta-llama/llama-3.3-70b-instruct:free</div>
        </div>
      </div>

      <div class="feature" onclick="toggleFeature(this)">
        <h3>Session persistence</h3>
        <p>Close your terminal, reboot, come back next week. Your conversation history, tool results, and context are preserved. Just run <code>hyle</code> again to continue.</p>
        <div class="feature-detail">
          <div class="feature-code"><span style="color:var(--green)">$</span> hyle
<span style="color:var(--dim)">[Resumed session a3f7c2d from 3 days ago]</span>
<span style="color:var(--dim)">[Context: OAuth2 flow for stripe-webhooks]</span>

<span style="color:var(--green)">></span> where were we?

We created <span style="color:var(--yellow)">src/auth/oauth.rs</span> with the
provider config. Next: callback handler...</div>
        </div>
      </div>

      <div class="feature" onclick="toggleFeature(this)">
        <h3>Guardrails and safety</h3>
        <p>Dangerous commands like <code>rm -rf</code> are blocked before execution. File writes are atomic with automatic backups. Rate limits handled with exponential backoff.</p>
        <div class="feature-detail">
          <div class="feature-code"><span style="color:var(--green)">></span> clean up the build artifacts
<span style="color:var(--red)">[BLOCKED]</span> rm -rf / matches dangerous pattern
<span style="color:var(--dim)">Refusing. Be more specific.</span>

<span style="color:var(--green)">></span> delete the ./target directory
<span style="color:var(--accent)">[bash]</span> rm -rf ./target
<span style="color:var(--green)">Removed ./target (1.2 GB freed)</span></div>
        </div>
      </div>

      <div class="feature" onclick="toggleFeature(this)">
        <h3>Instant slash commands</h3>
        <p>20+ commands that execute locally with zero latency. <code>/build</code> <code>/test</code> <code>/diff</code> <code>/commit</code> - no API calls needed.</p>
        <div class="feature-detail">
          <div class="feature-code"><span style="color:var(--green)">></span> /status
<span style="color:var(--yellow)">Modified:</span> src/lib.rs, src/parser.rs
<span style="color:var(--yellow)">Staged:</span> tests/integration.rs

<span style="color:var(--green)">></span> /diff src/lib.rs
<span style="color:var(--red)">-    let result = parse(input)?;</span>
<span style="color:var(--green)">+    let result = parse(input)
+        .map_err(|e| anyhow!("Parse: {}", e))?;</span></div>
        </div>
      </div>

      <div class="feature" onclick="toggleFeature(this)">
        <h3>Cost and context telemetry</h3>
        <p>Always know what you're spending. Token counts, latency traces, and context budget visible in the UI.</p>
        <div class="feature-detail">
          <div class="feature-code"><span style="color:var(--green)">></span> /cost
<span style="color:var(--yellow)">Session: a3f7c2d</span>
  Tokens in:  47,832  ($0.024)
  Tokens out: 12,441  ($0.037)
  Total cost: $0.061

<span style="color:var(--yellow)">Context:</span> 62,441 / 128,000 (48.8%)</div>
        </div>
      </div>
    </div>

    <div class="section-header">
      <h2>Real-world examples</h2>
      <p>Click to expand and see the actual prompts</p>
    </div>

    <div class="examples-grid">
      <div class="example-card" onclick="toggleExample(this)">
        <div class="example-header">
          <span class="example-icon">&#x1F4DD;</span>
          <div class="example-info">
            <div class="example-title">Stripe webhook types from JSON</div>
            <div class="example-subtitle">Paste API response, get serde structs</div>
          </div>
          <span class="example-tag easy">painless</span>
          <span class="example-expand">&#x25BC;</span>
        </div>
        <div class="example-body">
          <div class="example-content">
            <p class="example-prose">
              You're integrating with Stripe's API and need to deserialize webhook payloads. Instead of manually transcribing JSON into Rust structs, paste a sample response and get types with proper serde attributes, Option&lt;T&gt; for nullable fields, and chrono DateTime handling.
            </p>
            <div class="example-terminal">
              <div class="example-terminal-header">
                <span>~/code/payment-service</span>
                <button class="copy-btn" onclick="copyPrompt(event, 'stripe')">copy prompt</button>
              </div>
              <div class="example-terminal-body">
<span style="color:var(--green)">></span> generate rust types from this stripe webhook:
{"id":"evt_1abc","type":"payment_intent.succeeded",
 "data":{"object":{"id":"pi_xyz","amount":2000,
 "currency":"usd","customer":"cus_123"}}}

<span style="color:var(--accent)">[write]</span> <span class="file" onclick="showFile(event,'stripe')">src/stripe/types.rs</span> (89 lines)
<span style="color:var(--accent)">[bash]</span> cargo check
<span style="color:var(--green)">Compiles successfully</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="example-card" onclick="toggleExample(this)">
        <div class="example-header">
          <span class="example-icon">&#x1F527;</span>
          <div class="example-info">
            <div class="example-title">Fix async lifetime errors</div>
            <div class="example-subtitle">Compiler error in, working code out</div>
          </div>
          <span class="example-tag easy">painless</span>
          <span class="example-expand">&#x25BC;</span>
        </div>
        <div class="example-body">
          <div class="example-content">
            <p class="example-prose">
              Rust's async lifetime errors are cryptic. "Lifetime may not live long enough" pointing at trait bounds you didn't write. Paste the error, hyle reads the file, understands ownership flow, and applies the fix.
            </p>
            <div class="example-terminal">
              <div class="example-terminal-header">
                <span>~/code/realtime-sync</span>
                <button class="copy-btn" onclick="copyPrompt(event, 'lifetime')">copy prompt</button>
              </div>
              <div class="example-terminal-body">
<span style="color:var(--green)">></span> fix this:
error[E0597]: `connection` does not live long enough
  --> src/ws/handler.rs:47:23

<span style="color:var(--accent)">[read]</span> <span class="file" onclick="showFile(event,'wshandler')">src/ws/handler.rs</span>
<span style="color:var(--dim)">The spawn requires 'static. Clone the Arc.</span>

<span style="color:var(--accent)">[patch]</span> src/ws/handler.rs
<span style="color:var(--green)">cargo check: ok</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="example-card" onclick="toggleExample(this)">
        <div class="example-header">
          <span class="example-icon">&#x1F9EA;</span>
          <div class="example-info">
            <div class="example-title">Generate tests from implementation</div>
            <div class="example-subtitle">Comprehensive coverage, edge cases included</div>
          </div>
          <span class="example-tag easy">painless</span>
          <span class="example-expand">&#x25BC;</span>
        </div>
        <div class="example-body">
          <div class="example-content">
            <p class="example-prose">
              You've written the parser, now you need tests. Point hyle at the module and it analyzes the public API, identifies edge cases, and generates a test file that exercises the paths that matter.
            </p>
            <div class="example-terminal">
              <div class="example-terminal-header">
                <span>~/code/markdown-compiler</span>
                <button class="copy-btn" onclick="copyPrompt(event, 'tests')">copy prompt</button>
              </div>
              <div class="example-terminal-body">
<span style="color:var(--green)">></span> write tests for src/parser/inline.rs

<span style="color:var(--accent)">[read]</span> <span class="file" onclick="showFile(event,'parser')">src/parser/inline.rs</span> (312 lines)
<span style="color:var(--accent)">[write]</span> tests/parser_inline_tests.rs (247 lines)

<span style="color:var(--dim)">Generated for:</span>
  parse_emphasis - 6 tests (nested, unmatched)
  parse_link - 8 tests (inline, reference)
  parse_code_span - 4 tests

<span style="color:var(--accent)">[bash]</span> cargo test parser_inline
<span style="color:var(--green)">23 tests passed</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="example-card" onclick="toggleExample(this)">
        <div class="example-header">
          <span class="example-icon">&#x1F512;</span>
          <div class="example-info">
            <div class="example-title">Add JWT auth to all routes</div>
            <div class="example-subtitle">Middleware, extractors, error handling</div>
          </div>
          <span class="example-tag easy">painless</span>
          <span class="example-expand">&#x25BC;</span>
        </div>
        <div class="example-body">
          <div class="example-content">
            <p class="example-prose">
              Security boilerplate is tedious. hyle reads your route handlers, creates JWT validation middleware with proper error responses, adds extractor types, and wires everything together.
            </p>
            <div class="example-terminal">
              <div class="example-terminal-header">
                <span>~/code/inventory-api</span>
                <button class="copy-btn" onclick="copyPrompt(event, 'jwt')">copy prompt</button>
              </div>
              <div class="example-terminal-body">
<span style="color:var(--green)">></span> add JWT auth to src/routes/*, return 401 for invalid

<span style="color:var(--accent)">[read]</span> src/routes/*.rs (4 files)
<span style="color:var(--accent)">[write]</span> <span class="file" onclick="showFile(event,'auth')">src/middleware/auth.rs</span> (78 lines)
<span style="color:var(--accent)">[write]</span> src/auth/claims.rs (34 lines)
<span style="color:var(--accent)">[patch]</span> src/routes/mod.rs (+12 lines)
<span style="color:var(--accent)">[patch]</span> Cargo.toml (jsonwebtoken = "9")

<span style="color:var(--accent)">[bash]</span> cargo test
<span style="color:var(--green)">47 tests passed</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="example-card" onclick="toggleExample(this)">
        <div class="example-header">
          <span class="example-icon">&#x1F3A8;</span>
          <div class="example-info">
            <div class="example-title">Description to Leptos component</div>
            <div class="example-subtitle">Reactive state, event handlers, CSS</div>
          </div>
          <span class="example-tag creative">creative</span>
          <span class="example-expand">&#x25BC;</span>
        </div>
        <div class="example-body">
          <div class="example-content">
            <p class="example-prose">
              You know what you want the UI to look like. Describe it in words and hyle generates a complete Leptos component with signals, derived state, event handlers, and CSS.
            </p>
            <div class="example-terminal">
              <div class="example-terminal-header">
                <span>~/code/file-manager</span>
                <button class="copy-btn" onclick="copyPrompt(event, 'leptos')">copy prompt</button>
              </div>
              <div class="example-terminal-body">
<span style="color:var(--green)">></span> create file browser component:
- tree view left (collapsible folders)
- file preview right
- breadcrumb nav top
- keyboard nav (j/k, enter to open)

<span style="color:var(--accent)">[write]</span> <span class="file" onclick="showFile(event,'filebrowser')">src/components/file_browser.rs</span>
<span style="color:var(--accent)">[write]</span> src/components/file_browser.css

<span style="color:var(--dim)">Created with:</span>
  - RwSignal&lt;Vec&lt;TreeNode&gt;&gt; for tree
  - create_effect for keyboard
  - Accessible ARIA attributes

<span style="color:var(--accent)">[bash]</span> trunk serve
<span style="color:var(--green)">http://localhost:8080</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="example-card" onclick="toggleExample(this)">
        <div class="example-header">
          <span class="example-icon">&#x1F504;</span>
          <div class="example-info">
            <div class="example-title">Port Python to Rust</div>
            <div class="example-subtitle">Idiomatic translation, not transliteration</div>
          </div>
          <span class="example-tag creative">creative</span>
          <span class="example-expand">&#x25BC;</span>
        </div>
        <div class="example-body">
          <div class="example-content">
            <p class="example-prose">
              That Python prototype is now a bottleneck. hyle understands Python idioms and maps them to Rust: dict comprehensions become iterators, context managers become RAII, exceptions become Result.
            </p>
            <div class="example-terminal">
              <div class="example-terminal-header">
                <span>~/code/image-processor</span>
                <button class="copy-btn" onclick="copyPrompt(event, 'pyrust')">copy prompt</button>
              </div>
              <div class="example-terminal-body">
<span style="color:var(--green)">></span> port to rust with tokio:

async def process_batch(paths):
    async with aiofiles.open("log.txt", "a") as log:
        for path in paths:
            try:
                img = Image.open(path)
                results[path.stem] = analyze(img)
            except Exception as e:
                await log.write(f"Failed: {e}\n")

<span style="color:var(--accent)">[write]</span> <span class="file" onclick="showFile(event,'processor')">src/processor.rs</span> (67 lines)
<span style="color:var(--accent)">[bash]</span> cargo clippy
<span style="color:var(--green)">No warnings</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="example-card" onclick="toggleExample(this)">
        <div class="example-header">
          <span class="example-icon">&#x1F680;</span>
          <div class="example-info">
            <div class="example-title">Entity to full CRUD stack</div>
            <div class="example-subtitle">Migrations, handlers, tests, OpenAPI</div>
          </div>
          <span class="example-tag wow">impressive</span>
          <span class="example-expand">&#x25BC;</span>
        </div>
        <div class="example-body">
          <div class="example-content">
            <p class="example-prose">
              Describe an entity's fields and hyle generates the complete vertical slice: SQLx migrations, model structs with validation, CRUD handlers, integration tests, and OpenAPI documentation. All following your existing patterns.
            </p>
            <div class="example-terminal">
              <div class="example-terminal-header">
                <span>~/code/saas-platform</span>
                <button class="copy-btn" onclick="copyPrompt(event, 'crud')">copy prompt</button>
              </div>
              <div class="example-terminal-body">
<span style="color:var(--green)">></span> create entity: Subscription
- id: UUID
- user_id: UUID (foreign key)
- plan: enum (free, pro, enterprise)
- status: enum (active, cancelled, past_due)
- current_period_end: DateTime
- stripe_subscription_id: Option&lt;String&gt;

<span style="color:var(--accent)">[write]</span> migrations/20260110_subscriptions.sql
<span style="color:var(--accent)">[write]</span> <span class="file" onclick="showFile(event,'subscription')">src/models/subscription.rs</span>
<span style="color:var(--accent)">[write]</span> src/handlers/subscriptions.rs
<span style="color:var(--accent)">[write]</span> tests/subscriptions_test.rs

<span style="color:var(--accent)">[bash]</span> sqlx migrate run && cargo test
<span style="color:var(--green)">12 tests passed. 5 files, 847 lines.</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="example-card" onclick="toggleExample(this)">
        <div class="example-header">
          <span class="example-icon">&#x1F504;</span>
          <div class="example-info">
            <div class="example-title">Split 2000-line monolith</div>
            <div class="example-subtitle">Modules, imports, Cargo.toml updates</div>
          </div>
          <span class="example-tag wow">impressive</span>
          <span class="example-expand">&#x25BC;</span>
        </div>
        <div class="example-body">
          <div class="example-content">
            <p class="example-prose">
              The file that started as "temporary" is now 2000 lines. hyle analyzes the dependency graph, identifies natural module boundaries, extracts code into proper structure, fixes imports, and verifies compilation.
            </p>
            <div class="example-terminal">
              <div class="example-terminal-header">
                <span>~/code/event-sourcing</span>
                <button class="copy-btn" onclick="copyPrompt(event, 'split')">copy prompt</button>
              </div>
              <div class="example-terminal-body">
<span style="color:var(--green)">></span> src/event_store.rs is 2000 lines, split into modules

<span style="color:var(--accent)">[read]</span> src/event_store.rs (2,147 lines)
<span style="color:var(--dim)">Found 6 clusters:</span>
  Storage (412) - Projection (387) - Snapshot (234)
  Subscription (298) - Aggregate (456) - Types (360)

<span style="color:var(--accent)">[mkdir]</span> src/event_store/
<span style="color:var(--accent)">[write]</span> src/event_store/mod.rs
<span style="color:var(--accent)">[write]</span> src/event_store/{storage,projection,...}.rs
<span style="color:var(--accent)">[delete]</span> src/event_store.rs

<span style="color:var(--accent)">[bash]</span> cargo test
<span style="color:var(--green)">All 89 tests pass</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="example-card" onclick="toggleExample(this)">
        <div class="example-header">
          <span class="example-icon">&#x1F41B;</span>
          <div class="example-info">
            <div class="example-title">Debug production panic</div>
            <div class="example-subtitle">Stack trace to root cause to fix</div>
          </div>
          <span class="example-tag wow">impressive</span>
          <span class="example-expand">&#x25BC;</span>
        </div>
        <div class="example-body">
          <div class="example-content">
            <p class="example-prose">
              Your monitoring alerts on a panic. Paste the stack trace, hyle correlates with source, identifies the failing unwrap, explains why, fixes error handling, and adds a regression test.
            </p>
            <div class="example-terminal">
              <div class="example-terminal-header">
                <span>~/code/trading-engine</span>
                <button class="copy-btn" onclick="copyPrompt(event, 'panic')">copy prompt</button>
              </div>
              <div class="example-terminal-body">
<span style="color:var(--green)">></span> sentry shows this, fix it:
panicked at 'called `Option::unwrap()` on `None`',
src/orderbook/matching.rs:142:35

<span style="color:var(--accent)">[read]</span> <span class="file" onclick="showFile(event,'orderbook')">src/orderbook/matching.rs</span>

<span style="color:var(--dim)">Line 142: let price = self.best_bid.unwrap();</span>
<span style="color:var(--dim)">Panics when orderbook empty (no bids).</span>

<span style="color:var(--accent)">[patch]</span> src/orderbook/matching.rs
<span style="color:var(--red)">-    let price = self.best_bid.unwrap();</span>
<span style="color:var(--green)">+    let Some(price) = self.best_bid else {</span>
<span style="color:var(--green)">+        return Err(MatchError::NoLiquidity);</span>
<span style="color:var(--green)">+    };</span>

<span style="color:var(--accent)">[write]</span> tests/orderbook_edge_cases.rs (+1 test)
<span style="color:var(--green)">34 tests passed</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="example-card" onclick="toggleExample(this)">
        <div class="example-header">
          <span class="example-icon">&#x1F4D1;</span>
          <div class="example-info">
            <div class="example-title">Spec to implementation</div>
            <div class="example-subtitle">Step-by-step with tests after each</div>
          </div>
          <span class="example-tag wow">impressive</span>
          <span class="example-expand">&#x25BC;</span>
        </div>
        <div class="example-body">
          <div class="example-content">
            <p class="example-prose">
              Paste a design doc and hyle implements incrementally - writing code, running tests after each step, proceeding only when they pass. Great for well-specified features.
            </p>
            <div class="example-terminal">
              <div class="example-terminal-header">
                <span>~/code/rate-limiter</span>
                <button class="copy-btn" onclick="copyPrompt(event, 'spec')">copy prompt</button>
              </div>
              <div class="example-terminal-body">
<span style="color:var(--green)">></span> implement, test after each step:
## Token Bucket Rate Limiter
- Configurable capacity and refill rate
- Thread-safe (Arc&lt;RateLimiter&gt;)
- Returns remaining tokens on check
- Multiple named buckets
- Async-compatible

<span style="color:var(--dim)">Step 1/5: Core TokenBucket</span>
<span style="color:var(--accent)">[write]</span> src/bucket.rs
<span style="color:var(--green)">4 tests passed</span>

<span style="color:var(--dim)">Step 2/5: Atomic refill</span>
<span style="color:var(--accent)">[patch]</span> src/bucket.rs
<span style="color:var(--green)">6 tests passed</span>

<span style="color:var(--dim)">...steps 3-5...</span>
<span style="color:var(--green)">All 34 tests pass. Docs generated.</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="cta">
      <a href="https://github.com/uprootiny/hyle" class="cta-button">View on GitHub</a>
      <span class="cta-secondary"><code>cargo install --git https://github.com/uprootiny/hyle</code></span>
    </div>
  </div>

  <footer>
    <p>MIT License &middot; <a href="https://github.com/uprootiny/hyle">Source</a> &middot; <a href="https://openrouter.ai/keys">Get Free API Key</a></p>
  </footer>

  <div class="modal-overlay" id="fileModal" onclick="closeModal(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
      <div class="modal-header">
        <span class="modal-title" id="modalTitle">src/example.rs</span>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>

  <div class="variant-switcher">
    <div class="switcher-toggle" onclick="toggleSwitcher()" title="Page variants">~</div>
    <div class="switcher-panel" id="switcherPanel">
      <a class="switcher-item active" href="index.html">Default</a>
      <a class="switcher-item" href="unix.html">Composable</a>
      <a class="switcher-item" href="velocity.html">Velocity</a>
      <a class="switcher-item" href="reliable.html">Reliable</a>
      <a class="switcher-item" href="depth.html">Depth</a>
      <a class="switcher-item" href="playful.html">Playful</a>
      <a class="switcher-item" href="observable.html">Observable</a>
      <a class="switcher-item" href="community.html">Community</a>
      <a class="switcher-item" href="indie.html">Independent</a>
      <a class="switcher-item" href="learn.html">Learning</a>
      <a class="switcher-item" href="control.html">Control</a>
      <a class="switcher-item" href="secure.html">Secure</a>
      <a class="switcher-item" href="flow.html">Flow</a>
    </div>
  </div>

  <script>
    const files = {
      stripe: { title: 'src/stripe/types.rs', content: `use serde::{Deserialize, Serialize};
use chrono::{DateTime, Utc};

#[derive(Debug, Clone, Deserialize)]
pub struct StripeEvent {
    pub id: String,
    #[serde(rename = "type")]
    pub event_type: String,
    pub data: EventData,
    pub created: i64,
}

#[derive(Debug, Clone, Deserialize)]
pub struct EventData {
    pub object: PaymentIntent,
}

#[derive(Debug, Clone, Deserialize)]
pub struct PaymentIntent {
    pub id: String,
    pub amount: i64,
    pub currency: String,
    pub customer: Option<String>,
    pub status: PaymentStatus,
}

#[derive(Debug, Clone, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum PaymentStatus {
    RequiresPaymentMethod,
    RequiresConfirmation,
    Succeeded,
    Canceled,
}` },
      wshandler: { title: 'src/ws/handler.rs', content: `use std::sync::Arc;
use tokio::sync::RwLock;

pub struct Connection {
    tx: tokio::sync::mpsc::Sender<Message>,
}

pub async fn handle_websocket(
    ws: WebSocket,
    connection: Arc<Connection>,
) {
    let (mut sink, mut stream) = ws.split();

    // Clone Arc for spawned task
    let conn = Arc::clone(&connection);
    tokio::spawn(async move {
        while let Some(msg) = stream.next().await {
            if let Ok(msg) = msg {
                conn.tx.send(msg).await.ok();
            }
        }
    });
}` },
      parser: { title: 'src/parser/inline.rs', content: `//! Inline parser for markdown emphasis, links, code spans

pub fn parse_emphasis(input: &str) -> IResult<&str, Inline> {
    alt((parse_strong, parse_regular))(input)
}

pub fn parse_link(input: &str) -> IResult<&str, Inline> {
    alt((parse_inline_link, parse_reference_link))(input)
}

pub fn parse_code_span(input: &str) -> IResult<&str, Inline> {
    let (input, backticks) = take_while1(|c| c == '\`')(input)?;
    let (input, content) = take_until(backticks)(input)?;
    Ok((input, Inline::Code(content.to_string())))
}` },
      auth: { title: 'src/middleware/auth.rs', content: `use axum::{extract::State, http::StatusCode, middleware::Next};
use jsonwebtoken::{decode, DecodingKey, Validation};

pub async fn jwt_auth<B>(
    State(state): State<AppState>,
    mut req: Request<B>,
    next: Next<B>,
) -> Result<Response, StatusCode> {
    let token = req.headers()
        .get("Authorization")
        .and_then(|h| h.to_str().ok())
        .and_then(|h| h.strip_prefix("Bearer "))
        .ok_or(StatusCode::UNAUTHORIZED)?;

    let claims = decode::<Claims>(
        token,
        &DecodingKey::from_secret(state.jwt_secret.as_bytes()),
        &Validation::default(),
    ).map_err(|_| StatusCode::UNAUTHORIZED)?.claims;

    req.extensions_mut().insert(claims);
    Ok(next.run(req).await)
}` },
      filebrowser: { title: 'src/components/file_browser.rs', content: `use leptos::*;

#[component]
pub fn FileBrowser() -> impl IntoView {
    let (tree, set_tree) = create_signal(Vec::<TreeNode>::new());
    let (selected, set_selected) = create_signal(None::<PathBuf>);

    create_effect(move |_| {
        let handler = window_event_listener("keydown", move |ev| {
            match ev.key().as_str() {
                "j" => move_selection_down(),
                "k" => move_selection_up(),
                "Enter" => toggle_or_open(),
                _ => {}
            }
        });
        on_cleanup(move || drop(handler));
    });

    view! {
        <div class="file-browser">
            <nav class="breadcrumb"><Breadcrumbs path=selected /></nav>
            <div class="panels">
                <aside><TreeView nodes=tree on_select=set_selected /></aside>
                <main><FilePreview path=selected /></main>
            </div>
        </div>
    }
}` },
      processor: { title: 'src/processor.rs', content: `use std::collections::HashMap;
use anyhow::Result;
use tokio::fs::OpenOptions;
use tokio::io::AsyncWriteExt;

pub async fn process_batch(
    paths: &[impl AsRef<Path>],
) -> Result<HashMap<String, Analysis>> {
    let mut results = HashMap::new();
    let mut log = OpenOptions::new()
        .append(true).create(true)
        .open("log.txt").await?;

    for path in paths {
        match process_single(path.as_ref()).await {
            Ok(analysis) => {
                let stem = path.as_ref().file_stem()
                    .and_then(|s| s.to_str())
                    .unwrap_or("unknown");
                results.insert(stem.to_string(), analysis);
            }
            Err(e) => {
                log.write_all(format!("Failed {}: {}\\n",
                    path.as_ref().display(), e).as_bytes()).await?;
            }
        }
    }
    Ok(results)
}` },
      subscription: { title: 'src/models/subscription.rs', content: `use chrono::{DateTime, Utc};
use serde::{Deserialize, Serialize};
use sqlx::FromRow;
use uuid::Uuid;

#[derive(Debug, Clone, Serialize, Deserialize, FromRow)]
pub struct Subscription {
    pub id: Uuid,
    pub user_id: Uuid,
    pub plan: Plan,
    pub status: SubscriptionStatus,
    pub current_period_end: DateTime<Utc>,
    pub stripe_subscription_id: Option<String>,
}

#[derive(Debug, Clone, Copy, Serialize, Deserialize, sqlx::Type)]
#[sqlx(type_name = "plan", rename_all = "lowercase")]
pub enum Plan { Free, Pro, Enterprise }

#[derive(Debug, Clone, Copy, Serialize, Deserialize, sqlx::Type)]
#[sqlx(type_name = "subscription_status", rename_all = "snake_case")]
pub enum SubscriptionStatus { Active, Cancelled, PastDue }

impl Subscription {
    pub fn is_active(&self) -> bool {
        matches!(self.status, SubscriptionStatus::Active)
            && self.current_period_end > Utc::now()
    }
}` },
      orderbook: { title: 'src/orderbook/matching.rs', content: `use rust_decimal::Decimal;
use thiserror::Error;

#[derive(Error, Debug)]
pub enum MatchError {
    #[error("no liquidity available")]
    NoLiquidity,
    #[error("insufficient quantity")]
    InsufficientQuantity,
}

impl OrderBook {
    pub fn match_market_buy(&mut self, qty: Decimal) -> Result<Fill, MatchError> {
        let Some(price) = self.best_ask else {
            return Err(MatchError::NoLiquidity);
        };

        let level = self.asks.get_mut(&price)
            .ok_or(MatchError::NoLiquidity)?;

        if level.quantity < qty {
            return Err(MatchError::InsufficientQuantity);
        }

        level.quantity -= qty;
        if level.quantity.is_zero() {
            self.asks.remove(&price);
            self.update_best_ask();
        }

        Ok(Fill { price, quantity: qty, side: Side::Buy })
    }
}` },
    };

    const prompts = {
      stripe: `Generate Rust types from this Stripe webhook JSON:\n{"id":"evt_1abc","type":"payment_intent.succeeded","data":{"object":{"id":"pi_xyz","amount":2000,"currency":"usd","customer":"cus_123","status":"succeeded"}}}\n\nUse serde derives, chrono for timestamps, Option<T> for nullable fields.`,
      lifetime: `Fix this async lifetime error:\nerror[E0597]: \`connection\` does not live long enough\n  --> src/ws/handler.rs:47:23\n   |\n47 |     tokio::spawn(async move {\n   |                       ^^^^^ borrowed value does not live long enough\n\nExplain what's wrong and fix it.`,
      tests: `Write comprehensive tests for src/parser/inline.rs\n\nCover:\n- All public functions\n- Edge cases (empty input, unicode, malformed)\n- Error paths\n\nRun cargo test after generating.`,
      jwt: `Add JWT authentication to all routes in src/routes/\n\nRequirements:\n- Use jsonwebtoken crate\n- Create middleware that extracts user from token\n- Return 401 for invalid tokens\n- Include tests for auth success/failure`,
      leptos: `Create a file browser component in Leptos:\n- Tree view on left (collapsible folders)\n- File preview on right\n- Breadcrumb navigation\n- Keyboard nav: j/k to move, Enter to open`,
      pyrust: `Port to idiomatic Rust with tokio:\n\nasync def process_batch(paths):\n    async with aiofiles.open("log.txt", "a") as log:\n        for path in paths:\n            try:\n                img = Image.open(path)\n                results[path.stem] = analyze(img)\n            except Exception as e:\n                await log.write(f"Failed: {e}\\n")`,
      crud: `Create entity: Subscription\n\nFields:\n- id: UUID\n- user_id: UUID (foreign key)\n- plan: enum (free, pro, enterprise)\n- status: enum (active, cancelled, past_due)\n- current_period_end: DateTime\n- stripe_subscription_id: Option<String>\n\nGenerate: migration, model, handlers, tests, OpenAPI.`,
      split: `src/event_store.rs is 2000+ lines. Split into logical modules.\n\n- Analyze dependency graph\n- Create src/event_store/ directory\n- Fix all imports\n- Verify tests pass`,
      panic: `Sentry shows this panic, find and fix:\n\nthread 'tokio-runtime-worker' panicked at\n'called \`Option::unwrap()\` on a \`None\` value',\nsrc/orderbook/matching.rs:142:35\n\nAdd a regression test.`,
      spec: `Implement this spec, run tests after each step:\n\n## Token Bucket Rate Limiter\n- Configurable capacity and refill rate\n- Thread-safe (Arc<RateLimiter>)\n- Returns remaining tokens on check\n- Multiple named buckets\n- Async-compatible`,
    };

    const demos = [
      { title: '~/code/axum-sessions', label: 'Redis session storage', lines: [
        { type: 'cmd', prompt: '$', text: 'hyle' },
        { type: 'output', text: '[Resumed session from yesterday]' },
        { type: 'cmd', prompt: '>', text: 'add redis session storage to the auth middleware' },
        { type: 'info', text: '[read] src/middleware/auth.rs (89 lines)' },
        { type: 'info', text: '[read] Cargo.toml' },
        { type: 'warn', text: 'Adding redis and async-session dependencies...' },
        { type: 'info', text: '[write] src/session/redis_store.rs (67 lines)' },
        { type: 'info', text: '[patch] src/middleware/auth.rs (+23 -4)' },
        { type: 'info', text: '[bash] cargo check' },
        { type: 'success', text: 'Compiles. Sessions now persist in Redis.' },
      ]},
      { title: '~/code/graphql-api', label: 'N+1 query fix', lines: [
        { type: 'cmd', prompt: '$', text: 'hyle --model claude-3-opus' },
        { type: 'cmd', prompt: '>', text: 'the users resolver is N+1ing, add dataloader' },
        { type: 'info', text: '[read] src/graphql/query.rs' },
        { type: 'info', text: '[read] src/graphql/types/user.rs' },
        { type: 'output', text: 'Found 3 places loading users in loops.' },
        { type: 'info', text: '[write] src/graphql/loaders/user_loader.rs' },
        { type: 'info', text: '[patch] src/graphql/query.rs' },
        { type: 'info', text: '[bash] cargo test graphql' },
        { type: 'success', text: '14 tests pass. Queries now batch lookups.' },
      ]},
      { title: '~/code/cli-toolkit', label: 'Test failures', lines: [
        { type: 'cmd', prompt: '$', text: 'hyle' },
        { type: 'cmd', prompt: '>', text: '/test' },
        { type: 'warn', text: '3 tests failed: test_parse_args, test_config, test_output' },
        { type: 'cmd', prompt: '>', text: 'fix the failing tests' },
        { type: 'info', text: '[read] tests/cli_tests.rs, src/args.rs, src/config.rs' },
        { type: 'output', text: 'Issues: 1. arg name changed 2. XDG paths 3. JSON format' },
        { type: 'info', text: '[patch] tests/cli_tests.rs' },
        { type: 'info', text: '[bash] cargo test' },
        { type: 'success', text: 'All 47 tests pass.' },
      ]},
      { title: '~/code/event-processor', label: 'Async refactor', lines: [
        { type: 'cmd', prompt: '$', text: 'hyle --free' },
        { type: 'output', text: '[Using qwen/qwen-2.5-coder-32b-instruct:free]' },
        { type: 'cmd', prompt: '>', text: 'convert src/processor.rs from sync to async tokio' },
        { type: 'info', text: '[read] src/processor.rs (234 lines)' },
        { type: 'output', text: 'Found: std::fs, std::thread::sleep, blocking HTTP' },
        { type: 'info', text: '[patch] src/processor.rs (+45 -38)' },
        { type: 'info', text: '[patch] Cargo.toml (tokio features)' },
        { type: 'info', text: '[bash] cargo clippy' },
        { type: 'success', text: 'Converted. No blocking calls remain.' },
      ]},
    ];

    let currentDemo = 0, currentLine = 0, isPlaying = true, interval = null;

    function renderLine(l) {
      const d = document.createElement('div');
      d.className = 'terminal-line';
      const c = l.type === 'cmd' ? `<span class="prompt">${l.prompt}</span> <span class="cmd">${l.text}</span>` :
        l.type === 'info' ? `<span class="info">${l.text}</span>` :
        l.type === 'success' ? `<span class="success">${l.text}</span>` :
        l.type === 'warn' ? `<span class="warn">${l.text}</span>` :
        `<span class="output">${l.text || '&nbsp;'}</span>`;
      d.innerHTML = c;
      return d;
    }

    function playNext() {
      const demo = demos[currentDemo], body = document.getElementById('terminalBody');
      if (currentLine < demo.lines.length) {
        body.appendChild(renderLine(demo.lines[currentLine++]));
        body.scrollTop = body.scrollHeight;
      } else stopReplay();
    }

    function startReplay() {
      isPlaying = true;
      document.getElementById('playBtn').textContent = 'Pause';
      document.getElementById('playBtn').classList.add('active');
      interval = setInterval(playNext, 450);
    }

    function stopReplay() {
      isPlaying = false;
      document.getElementById('playBtn').textContent = 'Play';
      document.getElementById('playBtn').classList.remove('active');
      if (interval) { clearInterval(interval); interval = null; }
    }

    function toggleReplay() { isPlaying ? stopReplay() : startReplay(); }

    function restartReplay() {
      stopReplay(); currentLine = 0;
      document.getElementById('terminalBody').innerHTML = '';
      startReplay();
    }

    function switchDemo(i) {
      stopReplay(); currentDemo = i; currentLine = 0;
      document.getElementById('terminalBody').innerHTML = '';
      document.getElementById('terminalTitle').textContent = demos[i].title;
      document.getElementById('demoLabel').textContent = demos[i].label;
      document.querySelectorAll('.demo-dot').forEach((d, j) => d.classList.toggle('active', i === j));
      startReplay();
    }

    function toggleFeature(el) {
      document.querySelectorAll('.feature.expanded').forEach(f => { if (f !== el) f.classList.remove('expanded'); });
      el.classList.toggle('expanded');
    }

    function toggleExample(el) {
      const was = el.classList.contains('expanded');
      document.querySelectorAll('.example-card.expanded').forEach(c => c.classList.remove('expanded'));
      if (!was) el.classList.add('expanded');
    }

    function copyPrompt(e, key) {
      e.stopPropagation();
      navigator.clipboard.writeText(prompts[key]).then(() => {
        const btn = e.target;
        btn.textContent = 'copied!';
        btn.classList.add('copied');
        setTimeout(() => { btn.textContent = 'copy prompt'; btn.classList.remove('copied'); }, 2000);
      });
    }

    function showFile(e, key) {
      e.stopPropagation();
      const f = files[key];
      if (!f) return;
      document.getElementById('modalTitle').textContent = f.title;
      const lines = f.content.split('\n');
      document.getElementById('modalBody').innerHTML = '<pre>' + lines.map((l, i) =>
        `<span class="line-number">${String(i + 1).padStart(3)}</span>${l.replace(/</g, '&lt;')}`
      ).join('\n') + '</pre>';
      document.getElementById('fileModal').classList.add('open');
    }

    function closeModal(e) {
      if (!e || e.target.id === 'fileModal') document.getElementById('fileModal').classList.remove('open');
    }

    function toggleSwitcher() { document.getElementById('switcherPanel').classList.toggle('open'); }

    document.addEventListener('click', e => {
      if (!e.target.closest('.variant-switcher')) document.getElementById('switcherPanel').classList.remove('open');
    });
    document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });
    window.addEventListener('load', () => setTimeout(startReplay, 500));
  </script>
</body>
</html>
